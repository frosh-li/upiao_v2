/*!
 FixedHeader 3.1.0
 Â©2009-2015 SpryMedia Ltd - datatables.net/license
*/

(function(e){"function"==typeof define&&define.amd?define(["jquery","table"],function(t){return e(t,window,document)}):"object"==typeof exports?module.exports=function(t,n){t||(t=window);if(!n||!n.fn.dataTable)n=require("table")(t,n).$;return e(n,t,t.document)}:e(jQuery,window,document)})(function(e,t,n,r){var i=e.fn.dataTable,s=0,o=function(n,r){if(!(this instanceof o))throw"FixedHeader must be initialised with the 'new' keyword.";!0===r&&(r={}),n=new i.Api(n),this.c=e.extend(!0,{},o.defaults,r),this.s={dt:n,position:{theadTop:0,tbodyTop:0,tfootTop:0,tfootBottom:0,width:0,left:0,tfootHeight:0,theadHeight:0,windowHeight:e(t).height(),visible:!0},headerMode:null,footerMode:null,autoWidth:n.settings()[0].oFeatures.bAutoWidth,namespace:".dtfc"+s++,scrollLeft:{header:-1,footer:-1},enable:!0},this.dom={floatingHeader:null,thead:e(n.table().header()),tbody:e(n.table().body()),tfoot:e(n.table().footer()),header:{host:null,floating:null,placeholder:null},footer:{host:null,floating:null,placeholder:null}},this.dom.header.host=this.dom.thead.parent(),this.dom.footer.host=this.dom.tfoot.parent();var u=n.settings()[0];if(u._fixedHeader)throw"FixedHeader already initialised on table "+u.nTable.id;u._fixedHeader=this,this._constructor()};return e.extend(o.prototype,{enable:function(e){this.s.enable=e,this.c.header&&this._modeChange("in-place","header",!0),this.c.footer&&this.dom.tfoot.length&&this._modeChange("in-place","footer",!0),this.update()},headerOffset:function(e){return e!==r&&(this.c.headerOffset=e,this.update()),this.c.headerOffset},footerOffset:function(e){return e!==r&&(this.c.footerOffset=e,this.update()),this.c.footerOffset},update:function(){this._positions(),this._scroll(!0)},_constructor:function(){var n=this,r=this.s.dt;e(t).on("scroll"+this.s.namespace,function(){n._scroll()}).on("resize"+this.s.namespace,function(){n.s.position.windowHeight=e(t).height(),n.update()}),r.on("column-reorder.dt.dtfc column-visibility.dt.dtfc draw.dt.dtfc",function(){n.update()}),r.on("destroy.dtfc",function(){r.off(".dtfc"),e(t).off(n.s.namespace)}),this._positions(),this._scroll()},_clone:function(t,n){var r=this.s.dt,i=this.dom[t],s="header"===t?this.dom.thead:this.dom.tfoot;!n&&i.floating?i.floating.removeClass("fixedHeader-floating fixedHeader-locked"):(i.floating&&(i.placeholder.remove(),i.floating.children().detach(),i.floating.remove()),i.floating=e(r.table().node().cloneNode(!1)).removeAttr("id").append(s).appendTo("body"),i.placeholder=s.clone(!1),i.host.append(i.placeholder),this._matchWidths(i.placeholder,i.floating))},_matchWidths:function(t,n){var r=function(r){var i=e(r,t).map(function(){return e(this).width()}).toArray();e(r,n).each(function(t){e(this).width(i[t]).css("min-width",i[t])})};r("th"),r("td")},_unsize:function(t){var n=this.dom[t].floating;n&&("footer"===t||"header"===t&&!this.s.autoWidth)&&e("th, td",n).css("width","")},_horizontal:function(e,t){var n=this.dom[e],r=this.s.position,i=this.s.scrollLeft;n.floating&&i[e]!==t&&(n.floating.css("left",r.left-t),i[e]=t)},_modeChange:function(e,t,n){var r=this.dom[t],i=this.s.position;if("in-place"===e){if(r.placeholder&&(r.placeholder.remove(),r.placeholder=null),this._unsize(t),r.host.append("header"===t?this.dom.thead:this.dom.tfoot),r.floating)r.floating.remove(),r.floating=null}else"in"===e?(this._clone(t,n),r.floating.addClass("fixedHeader-floating").css("header"===t?"top":"bottom",this.c[t+"Offset"]).css("left",i.left+"px").css("width",i.width+"px"),"footer"===t&&r.floating.css("top","")):"below"===e?(this._clone(t,n),r.floating.addClass("fixedHeader-locked").css("top",i.tfootTop-i.theadHeight).css("left",i.left+"px").css("width",i.width+"px")):"above"===e&&(this._clone(t,n),r.floating.addClass("fixedHeader-locked").css("top",i.tbodyTop).css("left",i.left+"px").css("width",i.width+"px"));this.s.scrollLeft.header=-1,this.s.scrollLeft.footer=-1,this.s[t+"Mode"]=e},_positions:function(){var t=this.s.dt.table(),n=this.s.position,r=this.dom,t=e(t.node()),i=t.children("thead"),s=t.children("tfoot"),r=r.tbody;n.visible=t.is(":visible"),n.width=t.outerWidth(),n.left=t.offset().left,n.theadTop=i.offset().top,n.tbodyTop=r.offset().top,n.theadHeight=n.tbodyTop-n.theadTop,s.length?(n.tfootTop=s.offset().top,n.tfootBottom=n.tfootTop+s.outerHeight(),n.tfootHeight=n.tfootBottom-n.tfootTop):(n.tfootTop=n.tbodyTop+r.outerHeight(),n.tfootBottom=n.tfootTop,n.tfootHeight=n.tfootTop)},_scroll:function(t){var r=e(n).scrollTop(),i=e(n).scrollLeft(),s=this.s.position,o;this.s.enable&&(this.c.header&&(o=!s.visible||r<=s.theadTop-this.c.headerOffset?"in-place":r<=s.tfootTop-s.theadHeight-this.c.headerOffset?"in":"below",(t||o!==this.s.headerMode)&&this._modeChange(o,"header",t),this._horizontal("header",i)),this.c.footer&&this.dom.tfoot.length)&&(r=!s.visible||r+s.windowHeight>=s.tfootBottom+this.c.footerOffset?"in-place":s.windowHeight+r>s.tbodyTop+s.tfootHeight+this.c.footerOffset?"in":"above",(t||r!==this.s.footerMode)&&this._modeChange(r,"footer",t),this._horizontal("footer",i))}}),o.version="3.1.0",o.defaults={header:!0,footer:!1,headerOffset:0,footerOffset:0},e.fn.dataTable.FixedHeader=o,e.fn.DataTable.FixedHeader=o,e(n).on("init.dt.dtb",function(e,t){if("dt"===e.namespace){var n=t.oInit.fixedHeader||i.defaults.fixedHeader;n&&!t._fixedHeader&&new o(t,n)}}),i.Api.register("fixedHeader()",function(){}),i.Api.register("fixedHeader.adjust()",function(){return this.iterator("table",function(e){(e=e._fixedHeader)&&e.update()})}),i.Api.register("fixedHeader.enable()",function(e){return this.iterator("table",function(t){(t=t._fixedHeader)&&t.enable(e!==r?e:!0)})}),i.Api.register("fixedHeader.disable()",function(){return this.iterator("table",function(e){(e=e._fixedHeader)&&e.enable(!1)})}),e.each(["header","footer"],function(e,t){i.Api.register("fixedHeader."+t+"Offset()",function(e){var n=this.context;return e===r?n.length&&n[0]._fixedHeader?n[0]._fixedHeader[t+"Offset"]():r:this.iterator("table",function(n){(n=n._fixedHeader)&&n[t+"Offset"](e)})})}),o});