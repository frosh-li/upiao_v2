/*! FixedColumns 3.2.0
 * Â©2010-2014 SpryMedia Ltd - datatables.net/license
 */

/**
 * @summary     FixedColumns
 * @description Freeze columns in place on a scrolling DataTable
 * @version     3.2.0
 * @file        dataTables.fixedColumns.js
 * @author      SpryMedia Ltd (www.sprymedia.co.uk)
 * @contact     www.sprymedia.co.uk/contact
 * @copyright   Copyright 2010-2014 SpryMedia Ltd.
 *
 * This source file is free software, available under the following license:
 *   MIT license - http://datatables.net/license/mit
 *
 * This source file is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 * or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.
 *
 * For details please refer to: http://www.datatables.net
 */

(function(e){typeof define=="function"&&define.amd?define(["jquery","table"],function(t){return e(t,window,document)}):typeof exports=="object"?module.exports=function(t,n){t||(t=window);if(!n||!n.fn.dataTable)n=require("table")(t,n).$;return e(n,t,t.document)}:e(jQuery,window,document)})(function(e,t,n,r){var i=e.fn.dataTable,s=function(t,n){var i=this;if(!(this instanceof s)){alert("FixedColumns warning: FixedColumns must be initialised with the 'new' keyword.");return}if(n===r||n===!0)n={};var o=e.fn.dataTable.camelToHungarian;o&&(o(s.defaults,s.defaults,!0),o(s.defaults,n));var u=(new e.fn.dataTable.Api(t)).settings()[0];this.s={dt:u,iTableColumns:u.aoColumns.length,aiOuterWidths:[],aiInnerWidths:[]},this.dom={scroller:null,header:null,body:null,footer:null,grid:{wrapper:null,dt:null,left:{wrapper:null,head:null,body:null,foot:null},right:{wrapper:null,head:null,body:null,foot:null}},clone:{left:{header:null,body:null,footer:null},right:{header:null,body:null,footer:null}}};if(u._oFixedColumns)throw"FixedColumns already initialised on this table";u._oFixedColumns=this,u._bInitComplete?this._fnConstruct(n):u.oApi._fnCallbackReg(u,"aoInitComplete",function(){i._fnConstruct(n)},"FixedColumns")};return e.extend(s.prototype,{fnUpdate:function(){this._fnDraw(!0)},fnRedrawLayout:function(){this._fnColCalc(),this._fnGridLayout(),this.fnUpdate()},fnRecalculateHeight:function(e){delete e._DTTC_iHeight,e.style.height="auto"},fnSetRowHeight:function(e,t){e.style.height=t+"px"},fnGetPosition:function(t){var n,r=this.s.dt.oInstance;if(!e(t).parents(".DTFC_Cloned").length)return r.fnGetPosition(t);if(t.nodeName.toLowerCase()==="tr")return n=e(t).index(),r.fnGetPosition(e("tr",this.s.dt.nTBody)[n]);var i=e(t).index();n=e(t.parentNode).index();var s=r.fnGetPosition(e("tr",this.s.dt.nTBody)[n]);return[s,i,r.oApi._fnVisibleToColumnIndex(this.s.dt,i)]},_fnConstruct:function(i){var o,u,a,f=this;if(typeof this.s.dt.oInstance.fnVersionCheck!="function"||this.s.dt.oInstance.fnVersionCheck("1.8.0")!==!0){alert("FixedColumns "+s.VERSION+" required DataTables 1.8.0 or later. "+"Please upgrade your DataTables installation");return}if(this.s.dt.oScroll.sX===""){this.s.dt.oInstance.oApi._fnLog(this.s.dt,1,"FixedColumns is not needed (no x-scrolling in DataTables enabled), so no action will be taken. Use 'FixedHeader' for column fixing when scrolling is not enabled");return}this.s=e.extend(!0,this.s,s.defaults,i);var l=this.s.dt.oClasses;this.dom.grid.dt=e(this.s.dt.nTable).parents("div."+l.sScrollWrapper)[0],this.dom.scroller=e("div."+l.sScrollBody,this.dom.grid.dt)[0],this._fnColCalc(),this._fnGridSetup();var c;e(this.dom.scroller).on("mouseover.DTFC touchstart.DTFC",function(){c="main"}).on("scroll.DTFC",function(e){!c&&e.originalEvent&&(c="main"),c==="main"&&(f.s.iLeftColumns>0&&(f.dom.grid.left.liner.scrollTop=f.dom.scroller.scrollTop),f.s.iRightColumns>0&&(f.dom.grid.right.liner.scrollTop=f.dom.scroller.scrollTop))});var h="onwheel"in n.createElement("div")?"wheel.DTFC":"mousewheel.DTFC";f.s.iLeftColumns>0&&e(f.dom.grid.left.liner).on("mouseover.DTFC touchstart.DTFC",function(){c="left"}).on("scroll.DTFC",function(e){!c&&e.originalEvent&&(c="left"),c==="left"&&(f.dom.scroller.scrollTop=f.dom.grid.left.liner.scrollTop,f.s.iRightColumns>0&&(f.dom.grid.right.liner.scrollTop=f.dom.grid.left.liner.scrollTop))}).on(h,function(e){var t=e.type==="wheel"?-e.originalEvent.deltaX:e.originalEvent.wheelDeltaX;f.dom.scroller.scrollLeft-=t}),f.s.iRightColumns>0&&e(f.dom.grid.right.liner).on("mouseover.DTFC touchstart.DTFC",function(){c="right"}).on("scroll.DTFC",function(e){!c&&e.originalEvent&&(c="right"),c==="right"&&(f.dom.scroller.scrollTop=f.dom.grid.right.liner.scrollTop,f.s.iLeftColumns>0&&(f.dom.grid.left.liner.scrollTop=f.dom.grid.right.liner.scrollTop))}).on(h,function(e){var t=e.type==="wheel"?-e.originalEvent.deltaX:e.originalEvent.wheelDeltaX;f.dom.scroller.scrollLeft-=t}),e(t).on("resize.DTFC",function(){f._fnGridLayout.call(f)});var p=!0,d=e(this.s.dt.nTable);d.on("draw.dt.DTFC",function(){f._fnDraw.call(f,p),p=!1}).on("column-sizing.dt.DTFC",function(){f._fnColCalc(),f._fnGridLayout(f)}).on("column-visibility.dt.DTFC",function(e,t,n,i,s){if(s===r||s)f._fnColCalc(),f._fnGridLayout(f),f._fnDraw(!0)}).on("destroy.dt.DTFC",function(){d.off("column-sizing.dt.DTFC column-visibility.dt.DTFC destroy.dt.DTFC draw.dt.DTFC"),e(f.dom.scroller).off("mouseover.DTFC touchstart.DTFC scroll.DTFC"),e(t).off("resize.DTFC"),e(f.dom.grid.left.liner).off("mouseover.DTFC touchstart.DTFC scroll.DTFC "+h),e(f.dom.grid.left.wrapper).remove(),e(f.dom.grid.right.liner).off("mouseover.DTFC touchstart.DTFC scroll.DTFC "+h),e(f.dom.grid.right.wrapper).remove()}),this._fnGridLayout(),this.s.dt.oInstance.fnDraw(!1)},_fnColCalc:function(){var t=this,n=0,r=0;this.s.aiInnerWidths=[],this.s.aiOuterWidths=[],e.each(this.s.dt.aoColumns,function(i,s){var o=e(s.nTh),u;if(!o.filter(":visible").length)t.s.aiInnerWidths.push(0),t.s.aiOuterWidths.push(0);else{var a=o.outerWidth();t.s.aiOuterWidths.length===0&&(u=e(t.s.dt.nTable).css("border-left-width"),a+=typeof u=="string"?1:parseInt(u,10)),t.s.aiOuterWidths.length===t.s.dt.aoColumns.length-1&&(u=e(t.s.dt.nTable).css("border-right-width"),a+=typeof u=="string"?1:parseInt(u,10)),t.s.aiOuterWidths.push(a),t.s.aiInnerWidths.push(o.width()),i<t.s.iLeftColumns&&(n+=a),t.s.iTableColumns-t.s.iRightColumns<=i&&(r+=a)}}),this.s.iLeftWidth=n,this.s.iRightWidth=r},_fnGridSetup:function(){var t=this,n=this._fnDTOverflow(),r;this.dom.body=this.s.dt.nTable,this.dom.header=this.s.dt.nTHead.parentNode,this.dom.header.parentNode.parentNode.style.position="relative";var i=e('<div class="DTFC_ScrollWrapper" style="position:relative; clear:both;"><div class="DTFC_LeftWrapper" style="position:absolute; top:0; left:0;"><div class="DTFC_LeftHeadWrapper" style="position:relative; top:0; left:0; overflow:hidden;"></div><div class="DTFC_LeftBodyWrapper" style="position:relative; top:0; left:0; overflow:hidden;"><div class="DTFC_LeftBodyLiner" style="position:relative; top:0; left:0; overflow-y:scroll;"></div></div><div class="DTFC_LeftFootWrapper" style="position:relative; top:0; left:0; overflow:hidden;"></div></div><div class="DTFC_RightWrapper" style="position:absolute; top:0; left:0;"><div class="DTFC_RightHeadWrapper" style="position:relative; top:0; left:0;"><div class="DTFC_RightHeadBlocker DTFC_Blocker" style="position:absolute; top:0; bottom:0;"></div></div><div class="DTFC_RightBodyWrapper" style="position:relative; top:0; left:0; overflow:hidden;"><div class="DTFC_RightBodyLiner" style="position:relative; top:0; left:0; overflow-y:scroll;"></div></div><div class="DTFC_RightFootWrapper" style="position:relative; top:0; left:0;"><div class="DTFC_RightFootBlocker DTFC_Blocker" style="position:absolute; top:0; bottom:0;"></div></div></div></div>')[0],s=i.childNodes[0],o=i.childNodes[1];this.dom.grid.dt.parentNode.insertBefore(i,this.dom.grid.dt),i.appendChild(this.dom.grid.dt),this.dom.grid.wrapper=i,this.s.iLeftColumns>0&&(this.dom.grid.left.wrapper=s,this.dom.grid.left.head=s.childNodes[0],this.dom.grid.left.body=s.childNodes[1],this.dom.grid.left.liner=e("div.DTFC_LeftBodyLiner",i)[0],i.appendChild(s)),this.s.iRightColumns>0&&(this.dom.grid.right.wrapper=o,this.dom.grid.right.head=o.childNodes[0],this.dom.grid.right.body=o.childNodes[1],this.dom.grid.right.liner=e("div.DTFC_RightBodyLiner",i)[0],r=e("div.DTFC_RightHeadBlocker",i)[0],r.style.width=n.bar+"px",r.style.right=-n.bar+"px",this.dom.grid.right.headBlock=r,r=e("div.DTFC_RightFootBlocker",i)[0],r.style.width=n.bar+"px",r.style.right=-n.bar+"px",this.dom.grid.right.footBlock=r,i.appendChild(o)),this.s.dt.nTFoot&&(this.dom.footer=this.s.dt.nTFoot.parentNode,this.s.iLeftColumns>0&&(this.dom.grid.left.foot=s.childNodes[2]),this.s.iRightColumns>0&&(this.dom.grid.right.foot=o.childNodes[2]))},_fnGridLayout:function(){var t=this.dom.grid,n=e(t.wrapper).width(),r=e(this.s.dt.nTable.parentNode).outerHeight(),i=e(this.s.dt.nTable.parentNode.parentNode).outerHeight(),s=this._fnDTOverflow(),o=this.s.iLeftWidth,u=this.s.iRightWidth,a,f=function(e,t){s.bar?e.style.width=t+s.bar+"px":(e.style.width=t+20+"px",e.style.paddingRight="20px",e.style.boxSizing="border-box")};s.x&&(r-=s.bar),t.wrapper.style.height=i+"px",this.s.iLeftColumns>0&&(t.left.wrapper.style.width=o+"px",t.left.wrapper.style.height="1px",t.left.body.style.height=r+"px",t.left.foot&&(t.left.foot.style.top=(s.x?s.bar:0)+"px"),f(t.left.liner,o),t.left.liner.style.height=r+"px"),this.s.iRightColumns>0&&(a=n-u,s.y&&(a-=s.bar),t.right.wrapper.style.width=u+"px",t.right.wrapper.style.left=a+"px",t.right.wrapper.style.height="1px",t.right.body.style.height=r+"px",t.right.foot&&(t.right.foot.style.top=(s.x?s.bar:0)+"px"),f(t.right.liner,u),t.right.liner.style.height=r+"px",t.right.headBlock.style.display=s.y?"block":"none",t.right.footBlock.style.display=s.y?"block":"none")},_fnDTOverflow:function(){var e=this.s.dt.nTable,t=e.parentNode,n={x:!1,y:!1,bar:this.s.dt.oScroll.iBarWidth};return e.offsetWidth>t.clientWidth&&(n.x=!0),e.offsetHeight>t.clientHeight&&(n.y=!0),n},_fnDraw:function(t){this._fnGridLayout(),this._fnCloneLeft(t),this._fnCloneRight(t),this.s.fnDrawCallback!==null&&this.s.fnDrawCallback.call(this,this.dom.clone.left,this.dom.clone.right),e(this).trigger("draw.dtfc",{leftClone:this.dom.clone.left,rightClone:this.dom.clone.right})},_fnCloneRight:function(e){if(this.s.iRightColumns<=0)return;var t=this,n,r,i=[];for(n=this.s.iTableColumns-this.s.iRightColumns;n<this.s.iTableColumns;n++)this.s.dt.aoColumns[n].bVisible&&i.push(n);this._fnClone(this.dom.clone.right,this.dom.grid.right,i,e)},_fnCloneLeft:function(e){if(this.s.iLeftColumns<=0)return;var t=this,n,r,i=[];for(n=0;n<this.s.iLeftColumns;n++)this.s.dt.aoColumns[n].bVisible&&i.push(n);this._fnClone(this.dom.clone.left,this.dom.grid.left,i,e)},_fnCopyLayout:function(t,n,r){var i=[],s=[],o=[];for(var u=0,a=t.length;u<a;u++){var f=[];f.nTr=e(t[u].nTr).clone(r,!1)[0];for(var l=0,c=this.s.iTableColumns;l<c;l++){if(e.inArray(l,n)===-1)continue;var h=e.inArray(t[u][l].cell,o);if(h===-1){var p=e(t[u][l].cell).clone(r,!1)[0];s.push(p),o.push(t[u][l].cell),f.push({cell:p,unique:t[u][l].unique})}else f.push({cell:s[h],unique:t[u][l].unique})}i.push(f)}return i},_fnClone:function(t,n,i,s){var o=this,u,a,f,l,c,h,p,d,v,m,g,y,b=this.s.dt;if(s){e(t.header).remove(),t.header=e(this.dom.header).clone(!0,!1)[0],t.header.className+=" DTFC_Cloned",t.header.style.width="100%",n.head.appendChild(t.header),m=this._fnCopyLayout(b.aoHeader,i,!0),g=e(">thead",t.header),g.empty();for(u=0,a=m.length;u<a;u++)g[0].appendChild(m[u].nTr);b.oApi._fnDrawHead(b,m,!0)}else{m=this._fnCopyLayout(b.aoHeader,i,!1),y=[],b.oApi._fnDetectHeader(y,e(">thead",t.header)[0]);for(u=0,a=m.length;u<a;u++)for(f=0,l=m[u].length;f<l;f++)y[u][f].cell.className=m[u][f].cell.className,e("span.DataTables_sort_icon",y[u][f].cell).each(function(){this.className=e("span.DataTables_sort_icon",m[u][f].cell)[0].className})}this._fnEqualiseHeights("thead",this.dom.header,t.header),this.s.sHeightMatch=="auto"&&e(">tbody>tr",o.dom.body).css("height","auto"),t.body!==null&&(e(t.body).remove(),t.body=null),t.body=e(this.dom.body).clone(!0)[0],t.body.className+=" DTFC_Cloned",t.body.style.paddingBottom=b.oScroll.iBarWidth+"px",t.body.style.marginBottom=b.oScroll.iBarWidth*2+"px",t.body.getAttribute("id")!==null&&t.body.removeAttribute("id"),e(">thead>tr",t.body).empty(),e(">tfoot",t.body).remove();var w=e("tbody",t.body)[0];e(w).empty();if(b.aiDisplay.length>0){var E=e(">thead>tr",t.body)[0];for(v=0;v<i.length;v++){p=i[v],d=e(b.aoColumns[p].nTh).clone(!0)[0],d.innerHTML="";var S=d.style;S.paddingTop="0",S.paddingBottom="0",S.borderTopWidth="0",S.borderBottomWidth="0",S.height=0,S.width=o.s.aiInnerWidths[p]+"px",E.appendChild(d)}e(">tbody>tr",o.dom.body).each(function(t){var n=this.cloneNode(!1);n.removeAttribute("id");var r=o.s.dt.oFeatures.bServerSide===!1?o.s.dt.aiDisplay[o.s.dt._iDisplayStart+t]:t,s=o.s.dt.aoData[r].anCells||e(this).children("td, th");for(v=0;v<i.length;v++)p=i[v],s.length>0&&(d=e(s[p]).clone(!0,!0)[0],n.appendChild(d));w.appendChild(n)})}else e(">tbody>tr",o.dom.body).each(function(t){d=this.cloneNode(!0),d.className+=" DTFC_NoData",e("td",d).html(""),w.appendChild(d)});t.body.style.width="100%",t.body.style.margin="0",t.body.style.padding="0";if(b.oScroller!==r){var x=b.oScroller.dom.force;n.forcer?n.forcer.style.height=x.style.height:(n.forcer=x.cloneNode(!0),n.liner.appendChild(n.forcer))}n.liner.appendChild(t.body),this._fnEqualiseHeights("tbody",o.dom.body,t.body);if(b.nTFoot!==null){if(s){t.footer!==null&&t.footer.parentNode.removeChild(t.footer),t.footer=e(this.dom.footer).clone(!0,!0)[0],t.footer.className+=" DTFC_Cloned",t.footer.style.width="100%",n.foot.appendChild(t.footer),m=this._fnCopyLayout(b.aoFooter,i,!0);var T=e(">tfoot",t.footer);T.empty();for(u=0,a=m.length;u<a;u++)T[0].appendChild(m[u].nTr);b.oApi._fnDrawHead(b,m,!0)}else{m=this._fnCopyLayout(b.aoFooter,i,!1);var N=[];b.oApi._fnDetectHeader(N,e(">tfoot",t.footer)[0]);for(u=0,a=m.length;u<a;u++)for(f=0,l=m[u].length;f<l;f++)N[u][f].cell.className=m[u][f].cell.className}this._fnEqualiseHeights("tfoot",this.dom.footer,t.footer)}var C=b.oApi._fnGetUniqueThs(b,e(">thead",t.header)[0]);e(C).each(function(e){p=i[e],this.style.width=o.s.aiInnerWidths[p]+"px"}),o.s.dt.nTFoot!==null&&(C=b.oApi._fnGetUniqueThs(b,e(">tfoot",t.footer)[0]),e(C).each(function(e){p=i[e],this.style.width=o.s.aiInnerWidths[p]+"px"}))},_fnGetTrNodes:function(e){var t=[];for(var n=0,r=e.childNodes.length;n<r;n++)e.childNodes[n].nodeName.toUpperCase()=="TR"&&t.push(e.childNodes[n]);return t},_fnEqualiseHeights:function(t,n,r){if(this.s.sHeightMatch=="none"&&t!=="thead"&&t!=="tfoot")return;var i=this,s,o,u,a,f,l,c=n.getElementsByTagName(t)[0],h=r.getElementsByTagName(t)[0],p=e(">"+t+">tr:eq(0)",n).children(":first"),d=p.outerHeight()-p.height(),v=this._fnGetTrNodes(c),m=this._fnGetTrNodes(h),g=[];for(s=0,o=m.length;s<o;s++)f=v[s].offsetHeight,l=m[s].offsetHeight,u=l>f?l:f,this.s.sHeightMatch=="semiauto"&&(v[s]._DTTC_iHeight=u),g.push(u);for(s=0,o=m.length;s<o;s++)m[s].style.height=g[s]+"px",v[s].style.height=g[s]+"px"}}),s.defaults={iLeftColumns:1,iRightColumns:0,fnDrawCallback:null,sHeightMatch:"semiauto"},s.version="3.2.0",i.Api.register("fixedColumns()",function(){return this}),i.Api.register("fixedColumns().update()",function(){return this.iterator("table",function(e){e._oFixedColumns&&e._oFixedColumns.fnUpdate()})}),i.Api.register("fixedColumns().relayout()",function(){return this.iterator("table",function(e){e._oFixedColumns&&e._oFixedColumns.fnRedrawLayout()})}),i.Api.register("rows().recalcHeight()",function(){return this.iterator("row",function(e,t){e._oFixedColumns&&e._oFixedColumns.fnRecalculateHeight(this.row(t).node())})}),i.Api.register("fixedColumns().rowIndex()",function(t){return t=e(t),t.parents(".DTFC_Cloned").length?this.rows({page:"current"}).indexes()[t.index()]:this.row(t).index()}),i.Api.register("fixedColumns().cellIndex()",function(t){t=e(t);if(t.parents(".DTFC_Cloned").length){var n=t.parent().index(),r=this.rows({page:"current"}).indexes()[n],i;if(t.parents(".DTFC_LeftWrapper").length)i=t.index();else{var s=this.columns().flatten().length;i=s-this.context[0]._oFixedColumns.s.iRightColumns+t.index()}return{row:r,column:this.column.index("toData",i),columnVisible:i}}return this.cell(t).index()}),e(n).on("init.dt.fixedColumns",function(t,n){if(t.namespace!=="dt")return;var r=n.oInit.fixedColumns,o=i.defaults.fixedColumns;if(r||o){var u=e.extend({},r,o);r!==!1&&new s(n,u)}}),e.fn.dataTable.FixedColumns=s,e.fn.DataTable.FixedColumns=s,s});