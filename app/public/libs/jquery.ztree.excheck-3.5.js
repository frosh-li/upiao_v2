/*
 * JQuery zTree excheck v3.5.19.2
 * http://zTree.me/
 *
 * Copyright (c) 2010 Hunter.z
 *
 * Licensed same as jquery - MIT License
 * http://www.opensource.org/licenses/mit-license.php
 *
 * email: hunter.z@263.net
 * Date: 2015-11-15
 */

(function(e){var t={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},n={check:{enable:!1,autoCheckTrigger:!1,chkStyle:t.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:t.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},r=function(e){var t=E.getRoot(e);t.radioCheckedList=[]},i=function(e){},s=function(e){var t=e.treeObj,n=b.event;t.bind(n.CHECK,function(t,n,r,i){t.srcEvent=n,y.apply(e.callback.onCheck,[t,r,i])})},o=function(e){var t=e.treeObj,n=b.event;t.unbind(n.CHECK)},u=function(e){var t=e.target,n=E.getSetting(e.data.treeId),r="",i=null,s="",o="",u=null,a=null;y.eqs(e.type,"mouseover")?n.check.enable&&y.eqs(t.tagName,"span")&&t.getAttribute("treeNode"+b.id.CHECK)!==null&&(r=y.getNodeMainDom(t).id,s="mouseoverCheck"):y.eqs(e.type,"mouseout")?n.check.enable&&y.eqs(t.tagName,"span")&&t.getAttribute("treeNode"+b.id.CHECK)!==null&&(r=y.getNodeMainDom(t).id,s="mouseoutCheck"):y.eqs(e.type,"click")&&n.check.enable&&y.eqs(t.tagName,"span")&&t.getAttribute("treeNode"+b.id.CHECK)!==null&&(r=y.getNodeMainDom(t).id,s="checkNode");if(r.length>0){i=E.getNodeCache(n,r);switch(s){case"checkNode":u=p.onCheckNode;break;case"mouseoverCheck":u=p.onMouseoverCheck;break;case"mouseoutCheck":u=p.onMouseoutCheck}}var f={stop:s==="checkNode",node:i,nodeEventType:s,nodeEventCallback:u,treeEventType:o,treeEventCallback:a};return f},a=function(e,t,n,r,i,s,o){if(!n)return;var u=e.data.key.checked;typeof n[u]=="string"&&(n[u]=y.eqs(n[u],"true")),n[u]=!!n[u],n.checkedOld=n[u],typeof n.nocheck=="string"&&(n.nocheck=y.eqs(n.nocheck,"true")),n.nocheck=!!n.nocheck||e.check.nocheckInherit&&r&&!!r.nocheck,typeof n.chkDisabled=="string"&&(n.chkDisabled=y.eqs(n.chkDisabled,"true")),n.chkDisabled=!!n.chkDisabled||e.check.chkDisabledInherit&&r&&!!r.chkDisabled,typeof n.halfCheck=="string"&&(n.halfCheck=y.eqs(n.halfCheck,"true")),n.halfCheck=!!n.halfCheck,n.check_Child_State=-1,n.check_Focus=!1,n.getCheckStatus=function(){return E.getCheckStatus(e,n)};if(e.check.chkStyle==b.radio.STYLE&&e.check.radioType==b.radio.TYPE_ALL&&n[u]){var a=E.getRoot(e);a.radioCheckedList.push(n)}},f=function(e,t,n){var r=e.data.key.checked;e.check.enable&&(E.makeChkFlag(e,t),n.push("<span ID='",t.tId,b.id.CHECK,"' class='",w.makeChkClass(e,t),"' treeNode",b.id.CHECK,t.nocheck===!0?" style='display:none;'":"","></span>"))},l=function(e,t){t.checkNode=function(e,t,n,r){var i=this.setting.data.key.checked;if(e.chkDisabled===!0)return;t!==!0&&t!==!1&&(t=!e[i]),r=!!r;if(e[i]===t&&!n)return;if(r&&y.apply(this.setting.callback.beforeCheck,[this.setting.treeId,e],true)==0)return;if(y.uCanDo(this.setting)&&this.setting.check.enable&&e.nocheck!==!0){e[i]=t;var s=x(e,b.id.CHECK,this.setting);(n||this.setting.check.chkStyle===b.radio.STYLE)&&w.checkNodeRelation(this.setting,e),w.setChkClass(this.setting,s,e),w.repairParentChkClassWithSelf(this.setting,e),r&&this.setting.treeObj.trigger(b.event.CHECK,[null,this.setting.treeId,e])}},t.checkAllNodes=function(e){w.repairAllChk(this.setting,!!e)},t.getCheckedNodes=function(e){var t=this.setting.data.key.children;return e=e!==!1,E.getTreeCheckedNodes(this.setting,E.getRoot(this.setting)[t],e)},t.getChangeCheckedNodes=function(){var e=this.setting.data.key.children;return E.getTreeChangeCheckedNodes(this.setting,E.getRoot(this.setting)[e])},t.setChkDisabled=function(e,t,n,r){t=!!t,n=!!n,r=!!r,w.repairSonChkDisabled(this.setting,e,t,r),w.repairParentChkDisabled(this.setting,e.getParentNode(),t,n)};var n=t.updateNode;t.updateNode=function(e,r){n&&n.apply(t,arguments);if(!e||!this.setting.check.enable)return;var i=x(e,this.setting);if(i.get(0)&&y.uCanDo(this.setting)){var s=x(e,b.id.CHECK,this.setting);(r==1||this.setting.check.chkStyle===b.radio.STYLE)&&w.checkNodeRelation(this.setting,e),w.setChkClass(this.setting,s,e),w.repairParentChkClassWithSelf(this.setting,e)}}},c={getRadioCheckedList:function(e){var t=E.getRoot(e).radioCheckedList;for(var n=0,r=t.length;n<r;n++)E.getNodeCache(e,t[n].tId)||(t.splice(n,1),n--,r--);return t},getCheckStatus:function(e,t){if(!e.check.enable||t.nocheck||t.chkDisabled)return null;var n=e.data.key.checked,r={checked:t[n],half:t.halfCheck?t.halfCheck:e.check.chkStyle==b.radio.STYLE?t.check_Child_State===2:t[n]?t.check_Child_State>-1&&t.check_Child_State<2:t.check_Child_State>0};return r},getTreeCheckedNodes:function(e,t,n,r){if(!t)return[];var i=e.data.key.children,s=e.data.key.checked,o=n&&e.check.chkStyle==b.radio.STYLE&&e.check.radioType==b.radio.TYPE_ALL;r=r?r:[];for(var u=0,a=t.length;u<a;u++){if(t[u].nocheck!==!0&&t[u].chkDisabled!==!0&&t[u][s]==n){r.push(t[u]);if(o)break}E.getTreeCheckedNodes(e,t[u][i],n,r);if(o&&r.length>0)break}return r},getTreeChangeCheckedNodes:function(e,t,n){if(!t)return[];var r=e.data.key.children,i=e.data.key.checked;n=n?n:[];for(var s=0,o=t.length;s<o;s++)t[s].nocheck!==!0&&t[s].chkDisabled!==!0&&t[s][i]!=t[s].checkedOld&&n.push(t[s]),E.getTreeChangeCheckedNodes(e,t[s][r],n);return n},makeChkFlag:function(e,t){if(!t)return;var n=e.data.key.children,r=e.data.key.checked,i=-1;if(t[n])for(var s=0,o=t[n].length;s<o;s++){var u=t[n][s],a=-1;if(e.check.chkStyle==b.radio.STYLE){u.nocheck===!0||u.chkDisabled===!0?a=u.check_Child_State:u.halfCheck===!0?a=2:u[r]?a=2:a=u.check_Child_State>0?2:0;if(a==2){i=2;break}a==0&&(i=0)}else if(e.check.chkStyle==b.checkbox.STYLE){u.nocheck===!0||u.chkDisabled===!0?a=u.check_Child_State:u.halfCheck===!0?a=1:u[r]?a=u.check_Child_State===-1||u.check_Child_State===2?2:1:a=u.check_Child_State>0?1:0;if(a===1){i=1;break}if(a===2&&i>-1&&s>0&&a!==i){i=1;break}if(i===2&&a>-1&&a<2){i=1;break}a>-1&&(i=a)}}t.check_Child_State=i}},h={},p={onCheckNode:function(e,t){if(t.chkDisabled===!0)return!1;var n=E.getSetting(e.data.treeId),r=n.data.key.checked;if(y.apply(n.callback.beforeCheck,[n.treeId,t],true)==0)return!0;t[r]=!t[r],w.checkNodeRelation(n,t);var i=x(t,b.id.CHECK,n);return w.setChkClass(n,i,t),w.repairParentChkClassWithSelf(n,t),n.treeObj.trigger(b.event.CHECK,[e,n.treeId,t]),!0},onMouseoverCheck:function(e,t){if(t.chkDisabled===!0)return!1;var n=E.getSetting(e.data.treeId),r=x(t,b.id.CHECK,n);return t.check_Focus=!0,w.setChkClass(n,r,t),!0},onMouseoutCheck:function(e,t){if(t.chkDisabled===!0)return!1;var n=E.getSetting(e.data.treeId),r=x(t,b.id.CHECK,n);return t.check_Focus=!1,w.setChkClass(n,r,t),!0}},d={},v={checkNodeRelation:function(e,t){var n,r,i,s=e.data.key.children,o=e.data.key.checked,u=b.radio;if(e.check.chkStyle==u.STYLE){var a=E.getRadioCheckedList(e);if(t[o])if(e.check.radioType==u.TYPE_ALL){for(r=a.length-1;r>=0;r--)n=a[r],n[o]&&n!=t&&(n[o]=!1,a.splice(r,1),w.setChkClass(e,x(n,b.id.CHECK,e),n),n.parentTId!=t.parentTId&&w.repairParentChkClassWithSelf(e,n));a.push(t)}else{var f=t.parentTId?t.getParentNode():E.getRoot(e);for(r=0,i=f[s].length;r<i;r++)n=f[s][r],n[o]&&n!=t&&(n[o]=!1,w.setChkClass(e,x(n,b.id.CHECK,e),n))}else if(e.check.radioType==u.TYPE_ALL)for(r=0,i=a.length;r<i;r++)if(t==a[r]){a.splice(r,1);break}}else t[o]&&(!t[s]||t[s].length==0||e.check.chkboxType.Y.indexOf("s")>-1)&&w.setSonNodeCheckBox(e,t,!0),!t[o]&&(!t[s]||t[s].length==0||e.check.chkboxType.N.indexOf("s")>-1)&&w.setSonNodeCheckBox(e,t,!1),t[o]&&e.check.chkboxType.Y.indexOf("p")>-1&&w.setParentNodeCheckBox(e,t,!0),!t[o]&&e.check.chkboxType.N.indexOf("p")>-1&&w.setParentNodeCheckBox(e,t,!1)},makeChkClass:function(e,t){var n=e.data.key.checked,r=b.checkbox,i=b.radio,s="";t.chkDisabled===!0?s=r.DISABLED:t.halfCheck?s=r.PART:e.check.chkStyle==i.STYLE?s=t.check_Child_State<1?r.FULL:r.PART:s=t[n]?t.check_Child_State===2||t.check_Child_State===-1?r.FULL:r.PART:t.check_Child_State<1?r.FULL:r.PART;var o=e.check.chkStyle+"_"+(t[n]?r.TRUE:r.FALSE)+"_"+s;return o=t.check_Focus&&t.chkDisabled!==!0?o+"_"+r.FOCUS:o,b.className.BUTTON+" "+r.DEFAULT+" "+o},repairAllChk:function(e,t){if(e.check.enable&&e.check.chkStyle===b.checkbox.STYLE){var n=e.data.key.checked,r=e.data.key.children,i=E.getRoot(e);for(var s=0,o=i[r].length;s<o;s++){var u=i[r][s];u.nocheck!==!0&&u.chkDisabled!==!0&&(u[n]=t),w.setSonNodeCheckBox(e,u,t)}}},repairChkClass:function(e,t){if(!t)return;E.makeChkFlag(e,t);if(t.nocheck!==!0){var n=x(t,b.id.CHECK,e);w.setChkClass(e,n,t)}},repairParentChkClass:function(e,t){if(!t||!t.parentTId)return;var n=t.getParentNode();w.repairChkClass(e,n),w.repairParentChkClass(e,n)},repairParentChkClassWithSelf:function(e,t){if(!t)return;var n=e.data.key.children;t[n]&&t[n].length>0?w.repairParentChkClass(e,t[n][0]):w.repairParentChkClass(e,t)},repairSonChkDisabled:function(e,t,n,r){if(!t)return;var i=e.data.key.children;t.chkDisabled!=n&&(t.chkDisabled=n),w.repairChkClass(e,t);if(t[i]&&r)for(var s=0,o=t[i].length;s<o;s++){var u=t[i][s];w.repairSonChkDisabled(e,u,n,r)}},repairParentChkDisabled:function(e,t,n,r){if(!t)return;t.chkDisabled!=n&&r&&(t.chkDisabled=n),w.repairChkClass(e,t),w.repairParentChkDisabled(e,t.getParentNode(),n,r)},setChkClass:function(e,t,n){if(!t)return;n.nocheck===!0?t.hide():t.show(),t.attr("class",w.makeChkClass(e,n))},setParentNodeCheckBox:function(e,t,n,r){var i=e.data.key.children,s=e.data.key.checked,o=x(t,b.id.CHECK,e);r||(r=t),E.makeChkFlag(e,t),t.nocheck!==!0&&t.chkDisabled!==!0&&(t[s]=n,w.setChkClass(e,o,t),e.check.autoCheckTrigger&&t!=r&&e.treeObj.trigger(b.event.CHECK,[null,e.treeId,t]));if(t.parentTId){var u=!0;if(!n){var a=t.getParentNode()[i];for(var f=0,l=a.length;f<l;f++)if(a[f].nocheck!==!0&&a[f].chkDisabled!==!0&&a[f][s]||(a[f].nocheck===!0||a[f].chkDisabled===!0)&&a[f].check_Child_State>0){u=!1;break}}u&&w.setParentNodeCheckBox(e,t.getParentNode(),n,r)}},setSonNodeCheckBox:function(e,t,n,r){if(!t)return;var i=e.data.key.children,s=e.data.key.checked,o=x(t,b.id.CHECK,e);r||(r=t);var u=!1;if(t[i])for(var a=0,f=t[i].length;a<f&&t.chkDisabled!==!0;a++){var l=t[i][a];w.setSonNodeCheckBox(e,l,n,r),l.chkDisabled===!0&&(u=!0)}t!=E.getRoot(e)&&t.chkDisabled!==!0&&(u&&t.nocheck!==!0&&E.makeChkFlag(e,t),t.nocheck!==!0&&t.chkDisabled!==!0?(t[s]=n,u||(t.check_Child_State=t[i]&&t[i].length>0?n?2:0:-1)):t.check_Child_State=-1,w.setChkClass(e,o,t),e.check.autoCheckTrigger&&t!=r&&t.nocheck!==!0&&t.chkDisabled!==!0&&e.treeObj.trigger(b.event.CHECK,[null,e.treeId,t]))}},m={tools:d,view:v,event:h,data:c};e.extend(!0,e.fn.zTree.consts,t),e.extend(!0,e.fn.zTree._z,m);var g=e.fn.zTree,y=g._z.tools,b=g.consts,w=g._z.view,E=g._z.data,S=g._z.event,x=y.$;E.exSetting(n),E.addInitBind(s),E.addInitUnBind(o),E.addInitCache(i),E.addInitNode(a),E.addInitProxy(u,!0),E.addInitRoot(r),E.addBeforeA(f),E.addZTreeTools(l);var T=w.createNodes;w.createNodes=function(e,t,n,r,i){T&&T.apply(w,arguments);if(!n)return;w.repairParentChkClassWithSelf(e,r)};var N=w.removeNode;w.removeNode=function(e,t){var n=t.getParentNode();N&&N.apply(w,arguments);if(!t||!n)return;w.repairChkClass(e,n),w.repairParentChkClass(e,n)};var C=w.appendNodes;w.appendNodes=function(e,t,n,r,i,s,o){var u="";return C&&(u=C.apply(w,arguments)),r&&E.makeChkFlag(e,r),u}})(jQuery);